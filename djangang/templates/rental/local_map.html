{% extends "base.html" %}
{% load static %}

{% block title %}Map{% endblock %}

{% block head %}
<script src='https://api.mapbox.com/mapbox-gl-js/v2.3.1/mapbox-gl.js'></script>
<link href='https://api.mapbox.com/mapbox-gl-js/v2.3.1/mapbox-gl.css' rel='stylesheet' />
{%  endblock %}

{% block content %}

<div id='map' style='width: 400px; height: 300px;'></div>

	<style>
		  body {
		margin: 0;
		padding: 0;
	  }

	  #map {
		position: absolute;
		top: 0;
		bottom: 0;
		width: 100%;
	  }
	  .marker {
      background-image: url({% static "marker.png"  %});
	  background-size: cover;
	  width: 50px;
	  height: 50px;
	  border-radius: 50%;
	  cursor: pointer;
	  }
        .mapboxgl-popup {
        max-width: 200px;
        }

        .mapboxgl-popup-content {
        text-align: center;
        font-family: 'Open Sans', sans-serif;
        }
	</style>

<script>

const geojson =
{
  "type": "FeatureCollection",
  "features": [
	{
	  "type": "Feature",
	  "properties": {
          "title": "Makita Impact Driver",
          "description": "Makita Impact Driver"
      },
	  "geometry": {
		"type": "Point",
		"coordinates": [
		  -105.2704381942749,
		  40.0009583427279
		]
	  }
	},
	{
	  "type": "Feature",
	  "properties": {},
	  "geometry": {
		"type": "Point",
		"coordinates": [
		  -105.25674819946289,
		  40.00595509901582
		]
	  }
	},
	{
	  "type": "Feature",
	  "properties": {},
	  "geometry": {
		"type": "Point",
		"coordinates": [
		  -105.26005268096924,
		  40.01029409068199
		]
	  }
	},
	{
	  "type": "Feature",
	  "properties": {},
	  "geometry": {
		"type": "Point",
		"coordinates": [
		  -105.2794075012207,
		  40.01131305630903
		]
	  }
	},
	{
	  "type": "Feature",
	  "properties": {},
	  "geometry": {
		"type": "Point",
		"coordinates": [
		  -105.2794075012207,
		  40.00480456254218
		]
	  }
	},
	{
	  "type": "Feature",
	  "properties": {},
	  "geometry": {
		"type": "Point",
		"coordinates": [
		  -105.27588844299315,
		  40.02768016097898
		]
	  }
	},
	{
	  "type": "Feature",
	  "properties": {},
	  "geometry": {
		"type": "Point",
		"coordinates": [
		  -105.26387214660645,
		  40.033792168980135
		]
	  }
	}
  ]
};

  mapboxgl.accessToken = 'pk.eyJ1Ijoic2FzdDI4ODMiLCJhIjoiY2wwZWJuNWk0MGhrMDNkcXRpYmN5cmhsbiJ9.WGzYt8gxP35lsgRxnzTopQ';
  var map = new mapboxgl.Map({
	container: 'map',
	style: 'mapbox://styles/mapbox/streets-v11',
	center: [-74.5, 40],
	zoom: 3
  });


for (const feature of geojson.features) {
  // create a HTML element for each feature
  const el = document.createElement('div');
  el.className = 'marker';

  // make a marker for each feature and add to the map
  new mapboxgl.Marker(el)
      .setLngLat(feature.geometry.coordinates)
      .setPopup(
      new mapboxgl.Popup({ offset: 25 }) // add popups
      .setHTML(
        `<h3>${feature.properties.title}</h3><p>${feature.properties.description}</p>`
      )
      )
      .addTo(map);
}

</script>


{% endblock %}